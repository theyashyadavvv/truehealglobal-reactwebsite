import{r as i,l as T,d as q,I as F,J as B,j as e,m as G,L as c,G as t,K,M as y,N,w as l,O as v,A as b,S as M,P as Y}from"./index-CSWpObML.js";const O={pending:{icon:b,color:"#f59e0b",label:"Pending"},confirmed:{icon:l,color:"#6366f1",label:"Confirmed"},accepted:{icon:l,color:"#6366f1",label:"Accepted"},processing:{icon:b,color:"#f59e0b",label:"Processing"},handover:{icon:v,color:"#3b82f6",label:"Handover"},picked_up:{icon:v,color:"#3b82f6",label:"Picked Up"},delivered:{icon:l,color:"#22c55e",label:"Delivered"},canceled:{icon:N,color:"#ef4444",label:"Cancelled"},failed:{icon:N,color:"#ef4444",label:"Failed"},refunded:{icon:y,color:"#8b5cf6",label:"Refunded"},refund_requested:{icon:y,color:"#8b5cf6",label:"Refund Requested"}};function Q(){const[r,o]=i.useState("running"),[k,H]=i.useState([]),[d,R]=i.useState([]),[S,m]=i.useState(!0),[w,u]=i.useState(!1),[J,U]=i.useState(1),{isLoggedIn:h}=T(),A=q();i.useEffect(()=>{if(!h){A("/login");return}I()},[h]),i.useEffect(()=>{r==="history"&&d.length===0&&L()},[r]);const I=async()=>{m(!0);try{const s=await F({offset:1,limit:20});H((s==null?void 0:s.orders)||(s==null?void 0:s.data)||(Array.isArray(s)?s:[]))}catch(s){console.error(s)}finally{m(!1)}},L=async()=>{u(!0);try{const s=await B({offset:1,limit:50});R((s==null?void 0:s.orders)||(s==null?void 0:s.data)||(Array.isArray(s)?s:[]))}catch(s){console.error(s)}finally{u(!1)}},g=s=>new Intl.NumberFormat("en-IN",{style:"currency",currency:"INR",maximumFractionDigits:0}).format(s||0),C=s=>s?new Date(s).toLocaleDateString("en-IN",{day:"2-digit",month:"short",year:"numeric",hour:"2-digit",minute:"2-digit"}):"",f=r==="running"?k:d,P=r==="running"?S:w;return e.jsxs("main",{className:"orders-page",children:[e.jsx("section",{className:"orders-page__hero",children:e.jsx("div",{className:"container",children:e.jsx(G.div,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},children:e.jsx("h1",{className:"orders-page__title",children:"My Orders"})})})}),e.jsx("section",{className:"orders-page__content section",children:e.jsxs("div",{className:"container",children:[e.jsxs("div",{className:"orders-page__tabs",children:[e.jsx("button",{className:`orders-tab ${r==="running"?"active":""}`,onClick:()=>o("running"),children:"Running Orders"}),e.jsx("button",{className:`orders-tab ${r==="history"?"active":""}`,onClick:()=>o("history"),children:"Order History"})]}),P?e.jsx("div",{className:"orders-loading",children:[1,2,3].map(s=>e.jsx("div",{className:"order-skeleton"},s))}):f.length===0?e.jsxs("div",{className:"orders-empty",children:[e.jsx("div",{className:"orders-empty__icon",children:"ðŸ“‹"}),e.jsx("h3",{children:r==="running"?"No active orders":"No order history"}),e.jsx("p",{children:r==="running"?"You don't have any running orders right now.":"You haven't placed any orders yet."}),e.jsx(c,{to:"/products",children:e.jsxs(t,{size:"lg",children:[e.jsx(K,{size:18})," Shop Now"]})})]}):e.jsx("div",{className:"orders-list",children:f.map((s,z)=>{const x=(s.order_status||"pending").toLowerCase().replace(/ /g,"_"),n=O[x]||O.pending,D=n.icon;return e.jsx(M,{delay:z*.05,children:e.jsxs("div",{className:"order-card-full",children:[e.jsxs("div",{className:"order-card-full__header",children:[e.jsxs("div",{children:[e.jsxs("h3",{className:"order-card-full__id",children:["Order #",s.id]}),e.jsx("p",{className:"order-card-full__date",children:C(s.created_at)})]}),e.jsxs("span",{className:"order-card-full__status",style:{color:n.color,background:`${n.color}15`},children:[e.jsx(D,{size:14})," ",n.label]})]}),s.details&&s.details.length>0&&e.jsxs("div",{className:"order-card-full__items",children:[s.details.slice(0,3).map((a,$)=>{var p,j,_;return e.jsxs("div",{className:"order-card-full__item",children:[e.jsx("img",{src:((p=a.item_details)==null?void 0:p.image_full_url)||"/assets/image/placeholder.png",alt:((j=a.item_details)==null?void 0:j.name)||"Item",onError:E=>E.target.src="/assets/image/placeholder.png"}),e.jsxs("div",{children:[e.jsx("p",{className:"item-name",children:((_=a.item_details)==null?void 0:_.name)||`Item #${a.item_id}`}),e.jsxs("p",{className:"item-meta",children:[g(a.price)," x ",a.quantity]})]})]},$)}),s.details.length>3&&e.jsxs("p",{className:"order-card-full__more",children:["+",s.details.length-3," more items"]})]}),e.jsxs("div",{className:"order-card-full__footer",children:[e.jsxs("div",{className:"order-card-full__total",children:[e.jsx("span",{children:"Total:"}),e.jsx("strong",{children:g(s.order_amount)})]}),e.jsxs("div",{className:"order-card-full__actions",children:[["pending","confirmed","accepted","processing","handover","picked_up"].includes(x)&&e.jsx(c,{to:`/order-tracking/${s.id}`,children:e.jsx(t,{size:"sm",children:"Track Order"})}),e.jsx(c,{to:`/orders/${s.id}`,children:e.jsxs(t,{size:"sm",variant:"accent",children:["Details ",e.jsx(Y,{size:14})]})})]})]})]})},s.id)})})]})})]})}export{Q as default};
