import{d as b,l as k,r as c,at as w,j as s}from"./index-Fyb7nwRQ.js";import{d as A,e as r,c as D,F as z,f as C,g as E}from"./index-DVyq6Rwj.js";const h={order_status:E,push_notification:r,payment:C,offer:z,default:r},M=()=>{const f=b(),{isLoggedIn:o}=k(),[m,x]=c.useState([]),[j,l]=c.useState(!0),[g,d]=c.useState("");c.useEffect(()=>{if(!o){l(!1),d("Please login to view notifications");return}u()},[o]);const u=async()=>{try{l(!0),d("");const t=await w(),i=Array.isArray(t)?t:(t==null?void 0:t.notifications)||(t==null?void 0:t.data)||[];x(i)}catch(t){console.error("Failed to load notifications",t),d(t.message||"Failed to load notifications")}finally{l(!1)}},N=t=>{const i=h[t]||h.default;return s.jsx(i,{size:20})},p=t=>{if(!t)return"";const i=Date.now()-new Date(t).getTime(),e=Math.floor(i/6e4);if(e<1)return"just now";if(e<60)return`${e}m ago`;const a=Math.floor(e/60);if(a<24)return`${a}h ago`;const n=Math.floor(a/24);return n<30?`${n}d ago`:new Date(t).toLocaleDateString()},_=t=>{var i;return((i=t.data)==null?void 0:i.title)||t.title||"Notification"},y=t=>{var i;return((i=t.data)==null?void 0:i.description)||t.description||t.body||""},v=t=>{var i;return t.image_full_url||((i=t.data)==null?void 0:i.image_full_url)||t.image||""},F=t=>{var i;return((i=t.data)==null?void 0:i.type)||t.type||"default"};return s.jsxs("div",{className:"notifications-page",children:[s.jsx("section",{className:"noti-page__hero",children:s.jsxs("div",{className:"container",children:[s.jsx("button",{className:"noti-page__back",onClick:()=>f(-1),children:s.jsx(A,{size:20})}),s.jsx("h1",{children:"Notifications"})]})}),s.jsx("section",{className:"container noti-page__body",children:j?s.jsx("div",{className:"noti-skeletons",children:[...Array(6)].map((t,i)=>s.jsx("div",{className:"noti-skeleton"},i))}):g?s.jsxs("div",{className:"noti-empty",children:[s.jsx(r,{size:48}),s.jsx("h3",{children:g}),!o&&s.jsx("button",{className:"noti-login-btn",onClick:()=>f("/login"),children:"Login"}),o&&s.jsx("button",{className:"noti-retry-btn",onClick:u,children:"Retry"})]}):m.length===0?s.jsxs("div",{className:"noti-empty",children:[s.jsx(r,{size:48}),s.jsx("h3",{children:"No Notifications"}),s.jsx("p",{children:"You're all caught up!"})]}):s.jsx("div",{className:"noti-list",children:m.map((t,i)=>{const e=v(t),a=F(t);return s.jsxs("div",{className:"noti-card",children:[s.jsx("div",{className:`noti-card__icon ${a}`,children:e?s.jsx("img",{src:e,alt:"",className:"noti-card__img",onError:n=>{n.target.style.display="none"}}):N(a)}),s.jsxs("div",{className:"noti-card__content",children:[s.jsx("h4",{className:"noti-card__title",children:_(t)}),s.jsx("p",{className:"noti-card__desc",children:y(t)}),s.jsxs("span",{className:"noti-card__time",children:[s.jsx(D,{size:12})," ",p(t.created_at||t.updated_at)]})]})]},t.id||i)})})})]})};export{M as default};
