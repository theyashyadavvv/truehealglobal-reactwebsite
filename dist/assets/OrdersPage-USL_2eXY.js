import{r as n,l as B,d as G,I as K,J as Y,j as e,m as J,L as m,G as l,K as U,M as H,N as k,w as h,O as S,A as R,S as X,P as Q}from"./index-BL3vTOoB.js";const A={pending:{icon:R,color:"#f59e0b",label:"Pending"},confirmed:{icon:h,color:"#6366f1",label:"Confirmed"},accepted:{icon:h,color:"#6366f1",label:"Accepted"},processing:{icon:R,color:"#f59e0b",label:"Processing"},handover:{icon:S,color:"#3b82f6",label:"Handover"},picked_up:{icon:S,color:"#3b82f6",label:"Picked Up"},delivered:{icon:h,color:"#22c55e",label:"Delivered"},canceled:{icon:k,color:"#ef4444",label:"Cancelled"},failed:{icon:k,color:"#ef4444",label:"Failed"},refunded:{icon:H,color:"#8b5cf6",label:"Refunded"},refund_requested:{icon:H,color:"#8b5cf6",label:"Refund Requested"}};function W(){const[i,u]=n.useState("running"),[L,w]=n.useState([]),[o,g]=n.useState([]),[C,f]=n.useState(!0),[I,x]=n.useState(!1),[z,D]=n.useState(1),[P,T]=n.useState(!0),{isLoggedIn:j}=B(),$=G();n.useEffect(()=>{if(!j){$("/login");return}E()},[j]),n.useEffect(()=>{i==="history"&&o.length===0&&p()},[i]);const E=async()=>{f(!0);try{const s=await K({offset:1,limit:20});w((s==null?void 0:s.orders)||(s==null?void 0:s.data)||(Array.isArray(s)?s:[]))}catch(s){console.error(s)}finally{f(!1)}},p=async(s=1,d=!1)=>{x(!0);try{const r=await Y({offset:s,limit:20}),c=(r==null?void 0:r.orders)||(r==null?void 0:r.data)||(Array.isArray(r)?r:[]);g(d?a=>[...a,...c]:c),D(s),T(c.length>=20)}catch(t){console.error(t)}finally{x(!1)}},y=s=>new Intl.NumberFormat("en-IN",{style:"currency",currency:"INR",maximumFractionDigits:0}).format(s||0),M=s=>s?new Date(s).toLocaleDateString("en-IN",{day:"2-digit",month:"short",year:"numeric",hour:"2-digit",minute:"2-digit"}):"",_=i==="running"?L:o,v=i==="running"?C:I;return e.jsxs("main",{className:"orders-page",children:[e.jsx("section",{className:"orders-page__hero",children:e.jsx("div",{className:"container",children:e.jsx(J.div,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},children:e.jsx("h1",{className:"orders-page__title",children:"My Orders"})})})}),e.jsx("section",{className:"orders-page__content section",children:e.jsxs("div",{className:"container",children:[e.jsxs("div",{className:"orders-page__tabs",children:[e.jsx("button",{className:`orders-tab ${i==="running"?"active":""}`,onClick:()=>u("running"),children:"Running Orders"}),e.jsx("button",{className:`orders-tab ${i==="history"?"active":""}`,onClick:()=>u("history"),children:"Order History"})]}),v?e.jsx("div",{className:"orders-loading",children:[1,2,3].map(s=>e.jsx("div",{className:"order-skeleton"},s))}):_.length===0?e.jsxs("div",{className:"orders-empty",children:[e.jsx("div",{className:"orders-empty__icon",children:"ðŸ“‹"}),e.jsx("h3",{children:i==="running"?"No active orders":"No order history"}),e.jsx("p",{children:i==="running"?"You don't have any running orders right now.":"You haven't placed any orders yet."}),e.jsx(m,{to:"/products",children:e.jsxs(l,{size:"lg",children:[e.jsx(U,{size:18})," Shop Now"]})})]}):e.jsx("div",{className:"orders-list",children:_.map((s,d)=>{const t=(s.order_status||"pending").toLowerCase().replace(/ /g,"_"),r=A[t]||A.pending,c=r.icon;return e.jsx(X,{delay:d*.05,children:e.jsxs("div",{className:"order-card-full",children:[e.jsxs("div",{className:"order-card-full__header",children:[e.jsxs("div",{children:[e.jsxs("h3",{className:"order-card-full__id",children:["Order #",s.id]}),e.jsx("p",{className:"order-card-full__date",children:M(s.created_at)})]}),e.jsxs("span",{className:"order-card-full__status",style:{color:r.color,background:`${r.color}15`},children:[e.jsx(c,{size:14})," ",r.label]})]}),s.details&&s.details.length>0&&e.jsxs("div",{className:"order-card-full__items",children:[s.details.slice(0,3).map((a,q)=>{var N,b,O;return e.jsxs("div",{className:"order-card-full__item",children:[e.jsx("img",{src:((N=a.item_details)==null?void 0:N.image_full_url)||"/assets/image/placeholder.png",alt:((b=a.item_details)==null?void 0:b.name)||"Item",onError:F=>F.target.src="/assets/image/placeholder.png"}),e.jsxs("div",{children:[e.jsx("p",{className:"item-name",children:((O=a.item_details)==null?void 0:O.name)||`Item #${a.item_id}`}),e.jsxs("p",{className:"item-meta",children:[y(a.price)," x ",a.quantity]})]})]},q)}),s.details.length>3&&e.jsxs("p",{className:"order-card-full__more",children:["+",s.details.length-3," more items"]})]}),e.jsxs("div",{className:"order-card-full__footer",children:[e.jsxs("div",{className:"order-card-full__total",children:[e.jsx("span",{children:"Total:"}),e.jsx("strong",{children:y(s.order_amount)})]}),e.jsxs("div",{className:"order-card-full__actions",children:[["pending","confirmed","accepted","processing","handover","picked_up"].includes(t)&&e.jsx(m,{to:`/order-tracking/${s.id}`,children:e.jsx(l,{size:"sm",children:"Track Order"})}),e.jsx(m,{to:`/orders/${s.id}`,children:e.jsxs(l,{size:"sm",variant:"accent",children:["Details ",e.jsx(Q,{size:14})]})})]})]})]})},s.id)})}),i==="history"&&P&&o.length>0&&!v&&e.jsx("div",{style:{textAlign:"center",marginTop:"1.5rem"},children:e.jsx(l,{size:"sm",variant:"accent",onClick:()=>p(z+1,!0),children:"Load More Orders"})})]})})]})}export{W as default};
