import{u as M,r as i,f as T,a as x,b as z,j as e,m as S,S as b,L as C,H as A,c as R}from"./index-BS7-dLVL.js";function B(){const{id:r}=M(),[n,j]=i.useState("items"),[p,k]=i.useState([]),[N,u]=i.useState("all"),[o,m]=i.useState([]),[h,v]=i.useState([]),[P,d]=i.useState(!0),[w,y]=i.useState(!1),[L,_]=i.useState(1),[$,g]=i.useState(!0),[F,I]=i.useState("");i.useEffect(()=>{r&&(d(!0),m([]),v([]),_(1),u("all"),Promise.all([T(r).catch(()=>[]),x(r,{offset:1,limit:20}).catch(()=>({products:[]}))]).then(([s,a])=>{var l;const t=Array.isArray(s)?s:(s==null?void 0:s.data)||[];k(t);const c=(a==null?void 0:a.products)||(a==null?void 0:a.items)||(a==null?void 0:a.data)||(Array.isArray(a)?a:[]);m(c),g(c.length>=20),c.length>0&&((l=c[0])!=null&&l.category_name)&&I(c[0].category_name)}).finally(()=>d(!1)))},[r]),i.useEffect(()=>{n==="stores"&&h.length===0&&(y(!0),z(r,{offset:1,limit:20}).then(s=>{v((s==null?void 0:s.stores)||(s==null?void 0:s.data)||(Array.isArray(s)?s:[]))}).catch(()=>{}).finally(()=>y(!1)))},[n,r]);const E=async()=>{const s=L+1;try{const a=await x(r,{offset:s,limit:20}),t=(a==null?void 0:a.products)||(a==null?void 0:a.items)||(a==null?void 0:a.data)||[];m(c=>[...c,...t]),g(t.length>=20),_(s)}catch(a){console.error(a)}},f=async s=>{u(s),d(!0),_(1);try{const t=await x(s==="all"?r:s,{offset:1,limit:20}),c=(t==null?void 0:t.products)||(t==null?void 0:t.items)||(t==null?void 0:t.data)||(Array.isArray(t)?t:[]);m(c),g(c.length>=20)}catch(a){console.error(a)}finally{d(!1)}},H=s=>new Intl.NumberFormat("en-IN",{style:"currency",currency:"INR",maximumFractionDigits:0}).format(s||0);return e.jsxs("main",{className:"catitem-page",children:[e.jsx("section",{className:"catitem-page__hero",children:e.jsx("div",{className:"container",children:e.jsxs(S.div,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},transition:{duration:.5},children:[e.jsx("h1",{className:"catitem-page__title",children:F||"Category Products"}),e.jsxs("p",{className:"catitem-page__subtitle",children:[o.length," item",o.length!==1?"s":""," available"]})]})})}),e.jsx("section",{className:"catitem-page__content section",children:e.jsxs("div",{className:"container",children:[p.length>0&&e.jsxs("div",{className:"catitem-page__subcats",children:[e.jsx("button",{className:`catitem-page__subcats-btn ${N==="all"?"active":""}`,onClick:()=>f("all"),children:"All"}),p.map(s=>e.jsx("button",{className:`catitem-page__subcats-btn ${N===s.id?"active":""}`,onClick:()=>f(s.id),children:s.name},s.id))]}),e.jsxs("div",{className:"catitem-page__tabs",children:[e.jsx("button",{className:`catitem-page__tab ${n==="items"?"active":""}`,onClick:()=>j("items"),children:"Products"}),e.jsx("button",{className:`catitem-page__tab ${n==="stores"?"active":""}`,onClick:()=>j("stores"),children:"Stores"})]}),n==="items"&&e.jsx(e.Fragment,{children:P?e.jsx("div",{className:"catitem-page__grid",children:[1,2,3,4,5,6].map(s=>e.jsx("div",{className:"catitem-skeleton"},s))}):o.length===0?e.jsxs("div",{className:"catitem-page__empty",children:[e.jsx("div",{className:"catitem-page__empty-icon",children:"ðŸ“¦"}),e.jsx("h3",{children:"No products found"}),e.jsx("p",{children:"This category doesn't have any products yet."})]}):e.jsxs(e.Fragment,{children:[e.jsx("div",{className:"catitem-page__grid",children:o.map((s,a)=>{var c;const t=s.image_full_url||s.image||"/assets/image/placeholder.png";return e.jsx(b,{delay:a*.03,children:e.jsxs(C,{to:`/products/${s.id}`,className:"catitem-card hover-lift",children:[e.jsxs("div",{className:"catitem-card__image hover-zoom",children:[s.discount>0&&e.jsxs("span",{className:"catitem-card__badge",children:[s.discount_type==="percent"?`${s.discount}%`:`â‚¹${s.discount}`," off"]}),e.jsx("img",{src:t,alt:s.name,onError:l=>l.target.src="/assets/image/placeholder.png"})]}),e.jsxs("div",{className:"catitem-card__body",children:[e.jsx("span",{className:"catitem-card__store",children:s.store_name||""}),e.jsx("h3",{className:"catitem-card__name",children:s.name}),e.jsxs("div",{className:"catitem-card__rating",children:[e.jsx(A,{className:"catitem-card__star"}),e.jsx("span",{children:((c=s.avg_rating)==null?void 0:c.toFixed(1))||"0.0"}),e.jsxs("span",{className:"catitem-card__reviews",children:["(",s.rating_count||0,")"]})]}),e.jsxs("div",{className:"catitem-card__footer",children:[e.jsx("span",{className:"catitem-card__price",children:H(s.price)}),e.jsx(S.button,{className:"catitem-card__cart-btn",whileHover:{scale:1.1},whileTap:{scale:.9},onClick:l=>l.preventDefault(),children:e.jsx(R,{size:16})})]})]})]})},s.id)})}),$&&e.jsx("div",{className:"catitem-page__loadmore",children:e.jsx("button",{className:"catitem-page__loadmore-btn",onClick:E,children:"Load More Products"})})]})}),n==="stores"&&e.jsx(e.Fragment,{children:w?e.jsx("div",{className:"catitem-page__grid",children:[1,2,3].map(s=>e.jsx("div",{className:"catitem-skeleton"},s))}):h.length===0?e.jsxs("div",{className:"catitem-page__empty",children:[e.jsx("div",{className:"catitem-page__empty-icon",children:"ðŸª"}),e.jsx("h3",{children:"No stores found"}),e.jsx("p",{children:"No stores in this category yet."})]}):e.jsx("div",{className:"catitem-page__grid",children:h.map((s,a)=>{var t;return e.jsx(b,{delay:a*.03,children:e.jsxs(C,{to:`/stores/${s.id}`,className:"catitem-card hover-lift",children:[e.jsx("div",{className:"catitem-card__image hover-zoom",children:e.jsx("img",{src:s.cover_photo_full_url||s.logo_full_url||s.logo||"/assets/image/placeholder.png",alt:s.name,onError:c=>c.target.src="/assets/image/placeholder.png"})}),e.jsxs("div",{className:"catitem-card__body",children:[e.jsx("h3",{className:"catitem-card__name",children:s.name}),e.jsxs("div",{className:"catitem-card__rating",children:[e.jsx(A,{className:"catitem-card__star"}),e.jsx("span",{children:((t=s.avg_rating)==null?void 0:t.toFixed(1))||"0.0"}),e.jsxs("span",{className:"catitem-card__reviews",children:["(",s.rating_count||0,")"]})]}),s.address&&e.jsx("p",{className:"catitem-card__address",children:s.address})]})]})},s.id)})})})]})})]})}export{B as default};
