import{r as t,d as T,j as e,m as E,e as L,g as z,G as j,h as f,L as q,i as V,v as B,k as F}from"./index-b569ztP6.js";function D(){const[o,x]=t.useState(1),[n,v]=t.useState("phone"),[m,w]=t.useState(""),[p,y]=t.useState(""),[u,N]=t.useState(""),[g,_]=t.useState(""),[h,P]=t.useState(""),[l,d]=t.useState(!1),[c,r]=t.useState(""),[b,S]=t.useState(""),k=T(),O=async s=>{s.preventDefault(),r(""),d(!0);try{const a=n==="phone"?m.replace(/\s/g,""):p,i=await V({email_or_phone:a,[n]:a});i.errors?r(Object.values(i.errors).flat().join(". ")):x(2)}catch(a){r(a.message||"Failed to send OTP")}finally{d(!1)}},C=async s=>{s.preventDefault(),r(""),d(!0);try{const a=n==="phone"?m.replace(/\s/g,""):p,i=await B({email_or_phone:a,[n]:a,reset_token:u,token:u});i.errors?r(Object.values(i.errors).flat().join(". ")):(S(i.token||u),x(3))}catch(a){r(a.message||"OTP verification failed")}finally{d(!1)}},R=async s=>{if(s.preventDefault(),r(""),g!==h){r("Passwords do not match");return}d(!0);try{const a=n==="phone"?m.replace(/\s/g,""):p,i=await F({email_or_phone:a,[n]:a,reset_token:b,token:b,password:g,confirm_password:h});i.errors?r(Object.values(i.errors).flat().join(". ")):k("/login")}catch(a){r(a.message||"Password reset failed")}finally{d(!1)}};return e.jsx("div",{className:"login-page",children:e.jsx("div",{className:"login-page__container",children:e.jsxs(E.div,{className:"login-page__card",initial:{opacity:0,y:20},animate:{opacity:1,y:0},transition:{duration:.5},children:[e.jsxs("div",{className:"login-page__header",children:[e.jsx("img",{src:"/assets/image/thg-logo.png",alt:"THG",className:"login-page__logo"}),e.jsx("h1",{children:o===1?"Forgot Password":o===2?"Verify OTP":"Reset Password"}),e.jsx("p",{children:o===1?"Enter your registered email or phone":o===2?"Enter the code sent to you":"Create a new password"})]}),o===1&&e.jsxs(e.Fragment,{children:[e.jsxs("div",{className:"login-page__tabs",children:[e.jsx("button",{className:`login-page__tab ${n==="phone"?"active":""}`,onClick:()=>v("phone"),children:"Phone"}),e.jsx("button",{className:`login-page__tab ${n==="email"?"active":""}`,onClick:()=>v("email"),children:"Email"})]}),e.jsxs("form",{className:"login-page__form",onSubmit:O,children:[c&&e.jsx("div",{style:{color:"#ef4444",background:"rgba(239,68,68,0.1)",padding:"0.75rem 1rem",borderRadius:8,marginBottom:"1rem",fontSize:"0.9rem"},children:c}),n==="phone"?e.jsxs("div",{className:"form-group",children:[e.jsx("label",{children:"Phone Number"}),e.jsxs("div",{className:"input-icon-wrapper",children:[e.jsx(L,{className:"input-icon"}),e.jsx("input",{type:"tel",placeholder:"+91 98765 43210",value:m,onChange:s=>w(s.target.value),required:!0})]})]}):e.jsxs("div",{className:"form-group",children:[e.jsx("label",{children:"Email Address"}),e.jsxs("div",{className:"input-icon-wrapper",children:[e.jsx(z,{className:"input-icon"}),e.jsx("input",{type:"email",placeholder:"john@example.com",value:p,onChange:s=>y(s.target.value),required:!0})]})]}),e.jsx(j,{type:"submit",size:"lg",block:!0,disabled:l,children:l?"Sending...":"Send OTP"})]})]}),o===2&&e.jsxs("form",{className:"login-page__form",onSubmit:C,children:[c&&e.jsx("div",{style:{color:"#ef4444",background:"rgba(239,68,68,0.1)",padding:"0.75rem 1rem",borderRadius:8,marginBottom:"1rem",fontSize:"0.9rem"},children:c}),e.jsxs("div",{className:"form-group",children:[e.jsx("label",{children:"Verification Code"}),e.jsxs("div",{className:"input-icon-wrapper",children:[e.jsx(f,{className:"input-icon"}),e.jsx("input",{type:"text",placeholder:"Enter OTP",value:u,onChange:s=>N(s.target.value),required:!0,maxLength:6})]})]}),e.jsx(j,{type:"submit",size:"lg",block:!0,disabled:l,children:l?"Verifying...":"Verify OTP"})]}),o===3&&e.jsxs("form",{className:"login-page__form",onSubmit:R,children:[c&&e.jsx("div",{style:{color:"#ef4444",background:"rgba(239,68,68,0.1)",padding:"0.75rem 1rem",borderRadius:8,marginBottom:"1rem",fontSize:"0.9rem"},children:c}),e.jsxs("div",{className:"form-group",children:[e.jsx("label",{children:"New Password"}),e.jsxs("div",{className:"input-icon-wrapper",children:[e.jsx(f,{className:"input-icon"}),e.jsx("input",{type:"password",placeholder:"New password",value:g,onChange:s=>_(s.target.value),required:!0,minLength:6})]})]}),e.jsxs("div",{className:"form-group",children:[e.jsx("label",{children:"Confirm Password"}),e.jsxs("div",{className:"input-icon-wrapper",children:[e.jsx(f,{className:"input-icon"}),e.jsx("input",{type:"password",placeholder:"Confirm password",value:h,onChange:s=>P(s.target.value),required:!0,minLength:6})]})]}),e.jsx(j,{type:"submit",size:"lg",block:!0,disabled:l,children:l?"Resetting...":"Reset Password"})]}),e.jsx("div",{className:"login-page__footer",children:e.jsxs("p",{children:["Remember your password? ",e.jsx(q,{to:"/login",children:"Sign In"})]})})]})})})}export{D as default};
