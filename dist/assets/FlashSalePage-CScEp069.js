import{V as p,aw as v,ax as k,r as c,j as a,L as y}from"./index-B7P4RGAv.js";import{i as u,c as F}from"./index-DgFAenf_.js";async function L(){return p(v)}async function $(t,{offset:i=1,limit:n=12}={}){return p(`${k}?flash_sale_id=${t}&offset=${i}&limit=${n}`)}const w=()=>{const[t,i]=c.useState([]),[n,d]=c.useState(null),[r,x]=c.useState([]),[j,o]=c.useState(!0),[_,h]=c.useState(!1);c.useEffect(()=>{m()},[]);const m=async()=>{try{o(!0);const s=await L(),e=(s==null?void 0:s.data)||(s==null?void 0:s.flash_sales)||s||[];i(e),e.length>0&&(d(e[0]),f(e[0].id))}catch(s){console.error("Failed to load flash sales",s)}finally{o(!1)}},f=async s=>{var e;try{h(!0);const l=await $(s);x(((e=l==null?void 0:l.data)==null?void 0:e.products)||(l==null?void 0:l.products)||(l==null?void 0:l.data)||l||[])}catch(l){console.error("Failed to load flash sale products",l)}finally{h(!1)}},N=s=>{d(s),f(s.id)},g=s=>{if(!s)return"";const e=new Date(s)-Date.now();if(e<=0)return"Ended";const l=Math.floor(e/36e5),S=Math.floor(e%36e5/6e4);return`${l}h ${S}m left`};return a.jsxs("div",{className:"flash-sale-page",children:[a.jsx("section",{className:"flash-sale__hero",children:a.jsxs("div",{className:"container",children:[a.jsxs("h1",{children:[a.jsx(u,{})," Flash Sales"]}),a.jsx("p",{children:"Limited time offers with amazing discounts!"})]})}),a.jsx("section",{className:"container flash-sale__body",children:j?a.jsx("div",{className:"flash-skeleton-grid",children:[...Array(6)].map((s,e)=>a.jsx("div",{className:"flash-skeleton"},e))}):t.length===0?a.jsxs("div",{className:"flash-empty",children:[a.jsx(u,{size:48}),a.jsx("h3",{children:"No Active Flash Sales"}),a.jsx("p",{children:"Check back later for exciting deals!"})]}):a.jsxs(a.Fragment,{children:[t.length>1&&a.jsx("div",{className:"flash-tabs",children:t.map(s=>a.jsxs("button",{className:`flash-tab ${(n==null?void 0:n.id)===s.id?"active":""}`,onClick:()=>N(s),children:[s.title||s.name||`Sale #${s.id}`,s.end_date&&a.jsxs("span",{className:"flash-tab__time",children:[a.jsx(F,{size:12})," ",g(s.end_date)]})]},s.id))}),_?a.jsx("div",{className:"flash-skeleton-grid",children:[...Array(6)].map((s,e)=>a.jsx("div",{className:"flash-skeleton"},e))}):r.length===0?a.jsx("p",{className:"flash-no-products",children:"No products in this sale"}):a.jsx("div",{className:"flash-products-grid",children:r.map(s=>a.jsxs(y,{to:`/products/${s.id}`,className:"flash-product-card",children:[a.jsxs("div",{className:"flash-product__img-wrap",children:[a.jsx("img",{src:s.image_full_url||s.image,alt:s.name}),s.discount>0&&a.jsxs("span",{className:"flash-product__badge",children:[s.discount_type==="percent"?`${s.discount}%`:`₹${s.discount}`," OFF"]}),s.available_stock!==void 0&&s.available_stock<=5&&a.jsxs("span",{className:"flash-product__stock",children:["Only ",s.available_stock," left!"]})]}),a.jsxs("div",{className:"flash-product__info",children:[a.jsx("h4",{children:s.name}),a.jsxs("div",{className:"flash-product__price",children:[a.jsxs("span",{className:"price-current",children:["₹",s.price]}),s.discount>0&&a.jsxs("span",{className:"price-original",children:["₹",s.price+s.discount]})]})]})]},s.id))})]})})]})};export{w as default};
