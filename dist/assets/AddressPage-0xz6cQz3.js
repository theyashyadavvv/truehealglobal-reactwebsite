import{r as t,l as F,d as z,q,j as e,m as N,G as u,t as b,a3 as I,a4 as P,s as L,S as R,a5 as $,a1 as B,N as D,a6 as G,a7 as M,a8 as T}from"./index-CSWpObML.js";function U(){const[l,h]=t.useState([]),[A,C]=t.useState(!0),[_,i]=t.useState(!1),[c,p]=t.useState(null),[r,d]=t.useState({address_type:"home",contact_person_name:"",contact_person_number:"",address:"",city:"",house:"",road:"",floor:"",latitude:"28.6139",longitude:"77.2090"}),[x,j]=t.useState(!1),[y,o]=t.useState(""),{isLoggedIn:g,user:n}=F(),w=z();t.useEffect(()=>{if(!g){w("/login");return}v()},[g]);const v=async()=>{try{const s=await q();h((s==null?void 0:s.addresses)||(s==null?void 0:s.data)||(Array.isArray(s)?s:[]))}catch(s){console.error(s)}finally{C(!1)}},S=s=>{p(s.id),d({address_type:s.address_type||"home",contact_person_name:s.contact_person_name||"",contact_person_number:s.contact_person_number||"",address:s.address||"",city:s.city||"",house:s.house||"",road:s.road||"",floor:s.floor||"",latitude:s.latitude||"28.6139",longitude:s.longitude||"77.2090"}),i(!0)},f=()=>{p(null),d({address_type:"home",contact_person_name:n?`${n.f_name||""} ${n.l_name||""}`.trim():"",contact_person_number:(n==null?void 0:n.phone)||"",address:"",city:"",house:"",road:"",floor:"",latitude:"28.6139",longitude:"77.2090"}),i(!0)},k=async s=>{if(s.preventDefault(),o(""),!r.address.trim()){o("Address is required");return}if(!r.contact_person_name.trim()){o("Name is required");return}j(!0);try{c?await G(c,r):await M(r),i(!1),await v()}catch(a){o(a.message||"Failed to save")}finally{j(!1)}},H=async s=>{try{await T(s),h(a=>a.filter(m=>m.id!==s))}catch(a){console.error(a)}},E={home:P,office:I};return e.jsxs("main",{className:"address-page",children:[e.jsx("section",{className:"address-page__hero",children:e.jsx("div",{className:"container",children:e.jsxs(N.div,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},style:{display:"flex",justifyContent:"space-between",alignItems:"center",flexWrap:"wrap",gap:"1rem"},children:[e.jsxs("div",{children:[e.jsx("h1",{className:"address-page__title",children:"My Addresses"}),e.jsxs("p",{className:"address-page__subtitle",children:[l.length," saved address",l.length!==1?"es":""]})]}),e.jsxs(u,{onClick:f,children:[e.jsx(b,{size:18})," Add New Address"]})]})})}),e.jsx("section",{className:"address-page__content section",children:e.jsxs("div",{className:"container",children:[A?e.jsx("div",{className:"addr-grid",children:[1,2,3].map(s=>e.jsx("div",{className:"addr-skeleton"},s))}):l.length===0&&!_?e.jsxs("div",{className:"addr-empty",children:[e.jsx("div",{className:"addr-empty__icon",children:"ðŸ“"}),e.jsx("h3",{children:"No addresses yet"}),e.jsx("p",{children:"Add your first delivery address"}),e.jsxs(u,{onClick:f,children:[e.jsx(b,{size:18})," Add Address"]})]}):e.jsx("div",{className:"addr-grid",children:l.map((s,a)=>{const m=E[s.address_type]||L;return e.jsx(R,{delay:a*.05,children:e.jsxs("div",{className:"addr-card",children:[e.jsxs("div",{className:"addr-card__header",children:[e.jsxs("span",{className:"addr-card__type",children:[e.jsx(m,{size:14})," ",s.address_type||"other"]}),e.jsxs("div",{className:"addr-card__actions",children:[e.jsx("button",{onClick:()=>S(s),children:e.jsx($,{size:14})}),e.jsx("button",{onClick:()=>H(s.id),children:e.jsx(B,{size:14})})]})]}),e.jsx("h4",{className:"addr-card__name",children:s.contact_person_name}),e.jsx("p",{className:"addr-card__address",children:s.address}),s.city&&e.jsx("p",{className:"addr-card__city",children:s.city}),s.contact_person_number&&e.jsx("p",{className:"addr-card__phone",children:s.contact_person_number})]})},s.id)})}),_&&e.jsx("div",{className:"addr-modal-overlay",onClick:()=>i(!1),children:e.jsxs(N.div,{className:"addr-modal",initial:{opacity:0,y:20},animate:{opacity:1,y:0},onClick:s=>s.stopPropagation(),children:[e.jsxs("div",{className:"addr-modal__header",children:[e.jsx("h3",{children:c?"Edit Address":"Add New Address"}),e.jsx("button",{onClick:()=>i(!1),children:e.jsx(D,{size:20})})]}),e.jsxs("form",{onSubmit:k,className:"addr-form",children:[y&&e.jsx("div",{className:"addr-form-error",children:y}),e.jsx("div",{className:"addr-form__types",children:["home","office","other"].map(s=>e.jsx("button",{type:"button",className:`addr-type-btn ${r.address_type===s?"active":""}`,onClick:()=>d(a=>({...a,address_type:s})),children:s},s))}),e.jsxs("div",{className:"addr-form__group",children:[e.jsx("label",{children:"Contact Name *"}),e.jsx("input",{type:"text",value:r.contact_person_name,onChange:s=>d(a=>({...a,contact_person_name:s.target.value})),required:!0})]}),e.jsxs("div",{className:"addr-form__group",children:[e.jsx("label",{children:"Phone Number *"}),e.jsx("input",{type:"tel",value:r.contact_person_number,onChange:s=>d(a=>({...a,contact_person_number:s.target.value})),required:!0})]}),e.jsxs("div",{className:"addr-form__group",children:[e.jsx("label",{children:"Full Address *"}),e.jsx("textarea",{rows:2,value:r.address,onChange:s=>d(a=>({...a,address:s.target.value})),required:!0})]}),e.jsxs("div",{className:"addr-form__row",children:[e.jsxs("div",{className:"addr-form__group",children:[e.jsx("label",{children:"House/Flat"}),e.jsx("input",{type:"text",value:r.house,onChange:s=>d(a=>({...a,house:s.target.value}))})]}),e.jsxs("div",{className:"addr-form__group",children:[e.jsx("label",{children:"Road"}),e.jsx("input",{type:"text",value:r.road,onChange:s=>d(a=>({...a,road:s.target.value}))})]})]}),e.jsxs("div",{className:"addr-form__row",children:[e.jsxs("div",{className:"addr-form__group",children:[e.jsx("label",{children:"Floor"}),e.jsx("input",{type:"text",value:r.floor,onChange:s=>d(a=>({...a,floor:s.target.value}))})]}),e.jsxs("div",{className:"addr-form__group",children:[e.jsx("label",{children:"City"}),e.jsx("input",{type:"text",value:r.city,onChange:s=>d(a=>({...a,city:s.target.value}))})]})]}),e.jsx(u,{type:"submit",size:"lg",block:!0,disabled:x,children:x?"Saving...":c?"Update Address":"Save Address"})]})]})})]})})]})}export{U as default};
